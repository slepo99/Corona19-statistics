<template>

  <form>
    <input type="text" v-model.trim="text" @input="searchPost" />
  </form>

  <div>
    <ul class="posts">
      <li class="posts-list" v-for="item in searchPost()" :key="item.id" @click="getModalData(item)">
        <div>
          <h2>{{ item.Country }}</h2>
        </div>
      </li>
    </ul>
  </div>

  <div class="dialog" v-if="show" @click="hideModal">
    <div @click.stop class="dialog-content" v-for="(data, id) in modalData" :key="id">
      <p>CountryCode: {{ data.CountryCode }}</p>
      <p>TotalConfirmed: {{ data.TotalConfirmed }}</p>
      <p>Total Deaths: {{ data.TotalDeaths }}</p>
    </div>
  </div>


</template>

<script>
import axios from "axios";

export default {
  data() {
    return {
      text: "",
      data: [],
      show: false,
      modalData: [],
    };
  },
  methods: {
    searchPost() {
      return this.data.filter((item) =>
        item.Country.toLowerCase().includes(this.text.toLowerCase())
      );
    },

    async getCountries() {
      try {
        const response = await axios.get("https://api.covid19api.com/summary");
        this.data = response.data.Countries;
      } catch (e) {
        alert("error");
      }
    },

    getModalData(val) {
      this.modalData.push(val);
      this.show = true;
    },

    hideModal() {
      this.modalData = [];
      this.show = false;
    },
  },

  computed: {},

  mounted() {
    this.getCountries();
  },
};
</script>

<style >
body {
  background: url(http://localhost:8080/img/world.2d69c62b.svg) fixed no-repeat;
  background-position-y: 40px;
  background-position-x: -120px;
  background-size: 115%;

}

.posts {
  display: flex;
  flex-wrap: wrap;
  justify-content: space-between;
  padding: 0;
  margin: 0 auto;
}

.posts-list {
  border: 1px solid teal;
  border-radius: 12px;
  width: 25%;
  text-align: center;
  list-style-type: none;
  margin: 30px;
  align-items: center;
  padding: 0;
}

.dialog {
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;
  background: rgba(0, 0, 0, 0.5);
  position: fixed;
  display: flex;
}

.dialog-content {
  margin: auto;
  background: rgb(36, 216, 57);
  border-radius: 12px;
  min-height: 50px;
  min-width: 200px;
  display: flex;
  padding: 20px;
  flex-direction: column;
  flex-wrap: nowrap;
  justify-content: space-around;
  align-items: center;
}
</style>
